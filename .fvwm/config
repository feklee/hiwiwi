CleanupColorsets
Colorset 0 fg black, bg rgb:b4/aa/94
Colorset 1 fg black, bg rgb:a1/b2/c8

# Colors for widgets (background, foreground, highlight):
SetEnv FVWM_WBG gray35
SetEnv FVWM_WFG black
SetEnv FVWM_WHL gray70

# Colors for windows (background foreground, highlight):
SetEnv FVWM_WINBG gray30
SetEnv FVWM_WINFG black
SetEnv FVWM_WINHL gray60


# Perl scripting support
# ======================

# Definition of a function to allow easy inline Perl preprocessing: Simply call
# the function with a perl expression enclosed in '%{' and '}%'.  Variables
# of type "$f::variable" can be used to store state in between function calls.
DestroyFunc .
AddToFunc .
+ I SendToModule FvwmPerl eval preprocess({ 'command' => 1 } , q~$*~)

AddToFunc StartFunction
+ I ModuleSynchronous FvwmPerl


# Window look and feel
# ====================
SetEnv FVWM_BORDER_WIDTH 12
ImagePath $HOME/.fvwm
Style * EWMHMiniIconOverride
Style * DecorateTransient
Style * !Iconifiable
Style * ClickToFocus
Style * ClickToFocusRaisesOff
Style * GrabFocusTransient
Style * TileCascadePlacement
Style * ForeColor $[FVWM_WINFG], BackColor $[FVWM_WINBG]
Style * HilightFore $[FVWM_WINFG], HilightBack $[FVWM_WINHL]
Style * MwmBorder, DepressableBorder
Style * NoIcon
Style * HandleWidth 12
Style * MwmBorder, MwmButtons, MwmFunctions
Style * Font "xft:DejaVuSans:size=10"
ButtonStyle Active 2 Pixmap "close_button_active.png"
ButtonStyle Inactive 2 Pixmap "close_button_inactive.png"
Borderstyle -- Raised
OpaqueMoveSize 100
HideGeometryWindow Never
SnapAttraction 10


# Keyboard and mouse
# ==================

# Removal of built-in default configuration
Key F1 R A -
Key Tab A M -
Key Escape A MC -
Mouse 1 TS A -
Mouse 1 F  A -
Mouse 2 R  A -
DestroyFunc FuncFvwmRaiseLowerX
Silent Key Help R A -
Key F1 R A -
DestroyMenu MenuFvwmRoot

EdgeScroll 0 0
Key U                     A CMS Restart
Key C                     A CMS FvwmConsole
Key G                     A CMS EscapeFunc
Key L                     A   4 Exec exec xscreensaver-command -lock
Key Escape                A   4 Exec exec xkill
Key XF86MonBrightnessDown A   - Exec exec xbacklight -dec 10
Key XF86MonBrightnessUp   A   - Exec exec xbacklight -inc 10
Mouse 1 T  A MyRaiseAndMove
Mouse 1 W  A Nop
Mouse 1 SF A MyRaiseAndResize
Mouse 1 2  A Close

AddToFunc MyRaiseAndResize
+ I Raise
+ M ThisWindow (!Maximized) Resize

AddToFunc MyRaiseAndMove
+ I Raise
+ M ThisWindow (!Maximized) Move


# Pager, desktop, and buttons panel
# =================================

DesktopSize 1x1
Module FvwmPager 0 8
*FvwmPager: Columns 1
*FvwmPager: Rows 9
*FvwmPager: Back gray5
*FvwmPager: Fore $[FVWM_WBG]
*FvwmPager: Font none
*FvwmPager: MiniIcons

# xxkb is not started from `~/.xinitrc`, because then sometimes it is swallowed
# by stalonetray: <https://sourceforge.net/p/xxkb/bugs/24/>
AddToFunc MySwallowXxkb
+ I *FvwmButtons: (1x1+1+9 Swallow(NoClose, UseOld, NoHints) "XXkb" \
                  "Exec exec xxkb")

Module FvwmButtons
Style FvwmButtons NeverFocus, NoTitle, TitleAtRight, Sticky, !Borders
Style FvwmButtons WindowListSkip, StaysOnBottom
*FvwmButtons: BoxSize fixed
*FvwmButtons: Columns 2
*FvwmButtons: Rows 10
*FvwmButtons: Padding 2 2
*FvwmButtons: Back $[FVWM_WBG]
*FvwmButtons: Fore $[FVWM_WFG]
*FvwmButtons: Frame 4
*FvwmButtons: Geometry 288x1620+0+0
*FvwmButtons: (2x9+0 Swallow(UseOld) "FvwmPager")
*FvwmButtons: (1x1+0+9 Swallow(NoClose, UseOld) "stalonetray")
MySwallowXxkb


# Automatic layout
# ================

# Colors appear in pager:
Style backgroundterm !Title, !Borders, !Handles, GrabFocus, Style *
Style backgroundterm BackColor gray5, HilightBack gray5
Style FvwmButtons BackColor "Dark Green"

# Icons shown in pager:
Style Emacs MiniIcon "/usr/share/icons/hicolor/scalable/apps/emacs.svg"
Style Firefox MiniIcon "/usr/share/icons/hicolor/48x48/apps/firefox.png"
Style Thunderbird MiniIcon \
      "/usr/share/icons/hicolor/48x48/apps/thunderbird.png"
Style Gramps MiniIcon "/usr/share/gramps/images/48x48/gramps.png"
Style Evince MiniIcon "/usr/share/icons/hicolor/48x48/apps/evince.png"
Style Acroread MiniIcon \
      "/opt/Adobe/Reader9/Resource/Icons/48x48/AdobeReader9.png"
Style Vuescan MiniIcon \
      "/usr/share/icons/gnome/48x48/devices/scanner.png"

AddToFunc MyMaximizeInLayer3
+ I All ("Firefox|Thunderbird|Gramps|Evince|Acroread|Emacs", Layer 3, \
        !Transient) \
    ResizeMove 2592p 1620p 288p 0p

AddToFunc MyUndecorateInLayer3
+ I All (Layer 3, !Transient) WindowStyle NoTitle, !Borders

AddToFunc MyUpdateLayer3
+ I MyUndecorateInLayer3
+ I UpdateStyles
+ I MyMaximizeInLayer3

AddToFunc MyUpdate
+ I Layer 0 3
+ I UpdateStyles # Firefox may open more windows now -> current may change
+ I MyUpdateLayer3

AddToFunc MyUpdateIfInList
+ I Current (Maximizable, \
    "Firefox|Thunderbird|Emacs|Gramps|Evince|Acroread|Vuescan") MyUpdate

AddToFunc MyResizeInLayer4
+ I Current (Layer 4, "Firefox") Resize 1024p 768p

# Some applications always put all windows in the same layer, e.g. Vuescan.
# Scale the transient windows. Moving them to layer 4 may also move the window
# to layer 4, at least with Vuescan this seems to be the case.
AddToFunc MyResizeTransientOnLayer3
+ I All (CurrentDesk, Layer 3, Transient, "Vuescan") Resize 1024p 768p

AddToFunc MyOnWindowAdd
+ I Any (CurrentDesk, Layer 3) MyResizeInLayer4
+ I None (CurrentDesk, Layer 3) MyUpdateIfInList
+ I MyResizeTransientOnLayer3
+ I MyUpdateBackgroundTerms

# Should be called every time a window is added, since background terms are
# recreated when closed by exiting the shell.
AddToFunc MyUpdateBackgroundTerms
+ I All ("backgroundterm") Layer 0 2

Module FvwmEvent
*FvwmEvent: Cmd
*FvwmEvent: add_window MyOnWindowAdd
*FvwmEvent: new_desk MyUpdateLayer3 # nice to have after restart

AddToFunc StartFunction
+ I UpdateBackgroundTerms
+ I MyUpdateLayer3

# The following settings are interpreted by EMACS, do not remove them.
# Local Variables:
# mode: fvwm
# fill-column: 80
# coding: utf-8
# End:
